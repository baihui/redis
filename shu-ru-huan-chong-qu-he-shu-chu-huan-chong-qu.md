

#### 输入缓冲区

**客户端状态的输入缓冲区用于保存客户端发送的命令请求**

    ``` C
    
    typedef struct redisClient { 
        ... 
        sds querybuf ; 
        ... 
    } redisClient; 
    
    ```

> 命令保存在querybuf中，它的类型是[sds字符串](/sdsdong-tai-zi-fu-4e3229.md)输入缓冲区的大小会根据输入内容动态地缩小或者扩大，但它的最大大小不能超过1GB，否则服务器将关闭这个客户端 



##### 命令解析

  
##### 命令查找


##### 命令执行






![](/assets/redis-shuru-shurchu.png)



#### 输出缓冲区


执行命令所得的命令回复会被保存在客户端状态的输出缓冲区里面，每个客户端都有两个输出缓冲区可用，一个缓冲区的大小是固定的，另一个缓冲区的大小是可变的：

* 固定大小(16kb)的缓冲区用于保存那些长度比较小的回复，比如OK、简短的字符串值、整数值、错误回复等等

* 可变大小的缓冲区用于保存那些长度比较大的回复，比如一个非常长的字符串值，一个由很多项组成的列表，一个包含了很多元素的集合等等。





> 当固定大小数组的空间已经用完，或者回复因为太大而没办法放进buf数组里面时，服务器就会开始使用可变大小缓冲区，通过使用链表来连接多个字符串对象，
 ![](/assets/屏幕快照 2018-09-13 上午10.07.57.png)

